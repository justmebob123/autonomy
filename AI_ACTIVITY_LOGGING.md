# AI Activity Logging

## Overview

The debug/QA mode now includes **real-time AI activity logging** that shows exactly what the AI is doing as it works to fix errors. This provides full visibility into the AI's decision-making process and helps you monitor progress.

## What You'll See

### Real-Time Activity Reports

As the AI works, you'll see formatted activity logs like this:

```
ğŸ”§ [AI Activity] Modifying file: src/main.py
   â””â”€ Operation: str_replace
   â””â”€ Replacing: old_method_name...
   â””â”€ With: new_method_name...

ğŸ“– [AI Activity] Reading file: src/utils.py

ğŸ” [AI Activity] Searching code
   â””â”€ Pattern: class PipelineCoordinator
   â””â”€ Files: **/*.py

ğŸ“ [AI Activity] Listing directory: src/pipeline
```

### Activity Summary

At the end of each debugging iteration, you'll see a summary:

```
ğŸ“Š AI Activity Summary (5 actions):
============================================================
  modify_python_file: 2 call(s)
  read_file: 2 call(s)
  search_code: 1 call(s)
============================================================
```

## Tool Icons

Each tool has a distinctive emoji icon for quick visual identification:

| Icon | Tool | Purpose |
|------|------|---------|
| ğŸ”§ | `modify_python_file` | Editing/fixing code |
| ğŸ“– | `read_file` | Reading file contents |
| ğŸ” | `search_code` | Searching for patterns |
| ğŸ“ | `list_directory` | Exploring directory structure |
| âœ¨ | `create_file` | Creating new files |
| ğŸ¤– | (generic) | Other tool operations |

## Information Displayed

### For File Modifications (ğŸ”§)
- File path being modified
- Operation type (str_replace, insert_after, append)
- Preview of old code being replaced (first 60 chars)
- Preview of new code being inserted (first 60 chars)

### For File Reading (ğŸ“–)
- File path being read

### For Code Search (ğŸ”)
- Search pattern
- File pattern (which files to search)

### For Directory Listing (ğŸ“)
- Directory path being listed

### For File Creation (âœ¨)
- File path being created

## Benefits

1. **Transparency**: See exactly what the AI is doing at each step
2. **Progress Monitoring**: Know when the AI is actively working vs. thinking
3. **Debugging**: Understand why certain files are being modified
4. **Learning**: Observe the AI's problem-solving approach
5. **Confidence**: Verify the AI is working on the right files

## Example Session

Here's what a typical debugging session looks like:

```
[2024-01-15 12:30:45] Starting debugging iteration 1...

ğŸ” [AI Activity] Searching code
   â””â”€ Pattern: start_phase
   â””â”€ Files: **/*.py

ğŸ“– [AI Activity] Reading file: src/job_executor.py

ğŸ”§ [AI Activity] Modifying file: src/job_executor.py
   â””â”€ Operation: str_replace
   â””â”€ Replacing: coordinator.start_phase...
   â””â”€ With: coordinator.begin_phase...

ğŸ“Š AI Activity Summary (3 actions):
============================================================
  modify_python_file: 1 call(s)
  read_file: 1 call(s)
  search_code: 1 call(s)
============================================================

âœ… Fixed 1 file(s): src/job_executor.py
```

## Implementation Details

### Location
- Activity logging is implemented in `pipeline/handlers.py`
- The `ToolCallHandler` class tracks all tool calls
- Each tool call is logged with timestamp and arguments

### Storage
- Activities are stored in `handler.activity_log` list
- Each entry contains:
  - `timestamp`: ISO format timestamp
  - `tool`: Tool name
  - `args`: Tool arguments

### Output
- Real-time logging uses Python's `logging` module at INFO level
- Summary is generated by `get_activity_summary()` method
- Displayed after each debugging iteration

## Configuration

Activity logging is **always enabled** in debug/QA mode with three verbosity levels:

### Verbosity Levels

#### Level 0 (Normal) - Default
Shows just the essential information:
```bash
python3 run.py --debug-qa \
  --follow ../my_project/.autonomous_logs/autonomous.log \
  --command "./autonomous ../my_project/" \
  ../test-automation/
```

Output:
```
ğŸ”§ [AI Activity] Modifying file: src/example.py
ğŸ“– [AI Activity] Reading file: src/utils.py
ğŸ” [AI Activity] Searching code: class MyClass
```

#### Level 1 (Verbose) - Use `-v`
Shows operation details and code previews:
```bash
python3 run.py --debug-qa -v \
  --follow ../my_project/.autonomous_logs/autonomous.log \
  --command "./autonomous ../my_project/" \
  ../test-automation/
```

Output:
```
ğŸ”§ [AI Activity] Modifying file: src/example.py
   â””â”€ Operation: str_replace
   â””â”€ Replacing: def old_function():...
   â””â”€ With: def new_function():...
```

#### Level 2 (Very Verbose) - Use `-vv`
Shows full arguments in tree format:
```bash
python3 run.py --debug-qa -vv \
  --follow ../my_project/.autonomous_logs/autonomous.log \
  --command "./autonomous ../my_project/" \
  ../test-automation/
```

Output:
```
ğŸ”§ [AI Activity] Modifying file: src/example.py
   â””â”€ Operation: str_replace
   â””â”€ Replacing: def old_function():...
   â””â”€ With: def new_function():...
   â””â”€ Full arguments:
      â”œâ”€ file_path: src/example.py
      â”œâ”€ operation: str_replace
      â”œâ”€ old_str: def old_function():\n    pass
      â”œâ”€ new_str: def new_function():\n    return True
```

### Activity Log File

All AI activities are also logged to `<project>/ai_activity.log` with timestamps:

```
[2024-01-15T12:30:45.123456] MODIFY: src/example.py (str_replace)
     OLD: def old_function():
     NEW: def new_function():

[2024-01-15T12:30:46.234567] READ: src/utils.py

[2024-01-15T12:30:47.345678] SEARCH: class MyClass in **/*.py
```

This file is automatically created and is in `.gitignore`.

## Command Line Examples

### Basic Usage (Normal Verbosity)
```bash
python3 run.py --debug-qa \
  --follow ../my_project/.autonomous_logs/autonomous.log \
  --command "./autonomous ../my_project/" \
  ../test-automation/
```

### Verbose Mode (Show Operation Details)
```bash
python3 run.py --debug-qa -v \
  --follow ../my_project/.autonomous_logs/autonomous.log \
  --command "./autonomous ../my_project/" \
  ../test-automation/
```

### Very Verbose Mode (Full Arguments)
```bash
python3 run.py --debug-qa -vv \
  --follow ../my_project/.autonomous_logs/autonomous.log \
  --command "./autonomous ../my_project/" \
  ../test-automation/
```

### Check Activity Log
```bash
# View real-time activity
tail -f ../test-automation/ai_activity.log

# View full activity history
cat ../test-automation/ai_activity.log
```

## Future Enhancements

Possible future additions:
- Filtering by tool type
- Timing information (how long each tool call took)
- Success/failure indicators
- Diff preview for file modifications
- Export to different formats (JSON, CSV)

## Related Documentation

- `PROCESS_CLEANUP_FIX.md` - Process cleanup improvements
- `DEBUG_QA_MODE.md` - Debug/QA mode overview
- `LINE_FIXER_ANALYSIS.md` - Line-based fixing system